<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-AI Platform</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.animate-bounce-1{animation:bounce 1s infinite 0ms}
.animate-bounce-2{animation:bounce 1s infinite 150ms}
.animate-bounce-3{animation:bounce 1s infinite 300ms}
.markdown-content h1{font-size:1.875rem;font-weight:bold;margin-top:1.5rem;margin-bottom:1rem}
.markdown-content h2{font-size:1.5rem;font-weight:bold;margin-top:1.25rem;margin-bottom:0.75rem}
.markdown-content h3{font-size:1.25rem;font-weight:bold;margin-top:1rem;margin-bottom:0.5rem}
.markdown-content p{margin-bottom:1rem}
.markdown-content strong{font-weight:bold}
.markdown-content em{font-style:italic}
.markdown-content code{background:rgba(0,0,0,0.3);padding:0.125rem 0.375rem;border-radius:0.25rem;font-family:monospace;font-size:0.875rem}
.markdown-content pre{background:rgba(0,0,0,0.4);padding:1rem;border-radius:0.5rem;overflow-x:auto;margin-bottom:1rem}
.markdown-content pre code{background:transparent;padding:0}
.markdown-content ul{list-style:disc;margin-left:1.5rem;margin-bottom:1rem}
.markdown-content ol{list-style:decimal;margin-left:1.5rem;margin-bottom:1rem}
.markdown-content li{margin-bottom:0.5rem}
.markdown-content a{color:#60a5fa;text-decoration:underline}
.custom-scrollbar::-webkit-scrollbar{width:8px}
.custom-scrollbar::-webkit-scrollbar-track{background:rgba(0,0,0,0.2)}
.custom-scrollbar::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.2);border-radius:4px}
</style>
</head>
<body>
<div id="app"></div>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel">
const {useState,useEffect,useRef}=React;
marked.setOptions({breaks:true,gfm:true});

// ‚ö†Ô∏è REPLACE THESE WITH YOUR VALUES
const SUPABASE_URL='YOUR_SUPABASE_URL';
const SUPABASE_ANON_KEY='YOUR_ANON_KEY';
const ADMIN_EMAIL='admin@example.com';
const INVITE_CODE='FAMILY2024'; // Change this to your secret invite code

const supabase=window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

const models=[
{id:'gemini-pro',name:'Gemini 2.5 Pro',provider:'google',endpoint:'gemini-2.0-flash-exp'},
{id:'cerebras',name:'Cerebras Llama 3.3 70B',provider:'cerebras',endpoint:'llama3.3-70b'},
{id:'groq',name:'Groq Llama 3.3 70B',provider:'groq',endpoint:'llama-3.3-70b-versatile'},
{id:'deepseek',name:'DeepSeek V3',provider:'deepseek',endpoint:'deepseek-chat'}
];
const SendIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>;
const UserIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="7" r="4"/><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/></svg>;
const SettingsIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6"/></svg>;
const LogOutIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>;
const TrashIcon=()=><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>;
const PlusIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
const MessageIcon=()=><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>;
const EditIcon=()=><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>;
const ShieldIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>;
const ImageIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>;
const PaperclipIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>;
const SparklesIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 3v18m9-9H3m15.364-6.364L5.636 17.636m12.728 0L5.636 6.364"/></svg>;
const ColumnsIcon=()=><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="12" y1="3" x2="12" y2="21"/></svg>;
function App(){
const [session,setSession]=useState(null);
const [view,setView]=useState('chat');
const [email,setEmail]=useState('');
const [password,setPassword]=useState('');
const [inviteCode,setInviteCode]=useState('');
const [isSignup,setIsSignup]=useState(false);
const [chats,setChats]=useState([]);
const [currentChatId,setCurrentChatId]=useState(null);
const [input,setInput]=useState('');
const [loading,setLoading]=useState(false);
const [apiKeys,setApiKeys]=useState({});
const [showSettings,setShowSettings]=useState(false);
const [showSidebar,setShowSidebar]=useState(true);
const [editingChatId,setEditingChatId]=useState(null);
const [editingName,setEditingName]=useState('');
const [isAdmin,setIsAdmin]=useState(false);
const [attachedFile,setAttachedFile]=useState(null);
const [compareMode,setCompareMode]=useState(false);
const [selectedModels,setSelectedModels]=useState(['cerebras','groq']);
const [imagePrompt,setImagePrompt]=useState('');
const [generatedImage,setGeneratedImage]=useState(null);
const messagesEndRef=useRef(null);
const fileInputRef=useRef(null);

const currentChat=chats.find(c=>c.id===currentChatId);

useEffect(()=>{
supabase.auth.getSession().then(({data:{session}})=>{
setSession(session);
if(session){
setIsAdmin(session.user.email===ADMIN_EMAIL);
loadUserData(session.user.id);
}
});
supabase.auth.onAuthStateChange((_event,session)=>{
setSession(session);
if(session){
setIsAdmin(session.user.email===ADMIN_EMAIL);
loadUserData(session.user.id);
}
});
},[]);

useEffect(()=>{
messagesEndRef.current?.scrollIntoView({behavior:'smooth'});
},[currentChat?.messages]);
const loadUserData=async(userId)=>{
const {data:chatsData}=await supabase.from('chats').select('*').eq('user_id',userId).order('created_at',{ascending:false});
if(chatsData?.length>0){
setChats(chatsData);
setCurrentChatId(chatsData[0].id);
}else{
createNewChat(userId);
}
const {data:keysData}=await supabase.from('api_keys').select('*').eq('user_id',userId);
const keysObj={};
keysData?.forEach(k=>{keysObj[k.provider]=k.key_value;});
setApiKeys(keysObj);
};

const createNewChat=async(userId)=>{
const {data}=await supabase.from('chats').insert([{user_id:userId||session.user.id,name:'New Chat',model:'cerebras',messages:[]}]).select().single();
if(data){
setChats([data,...chats]);
setCurrentChatId(data.id);
}
};

const deleteChat=async(chatId)=>{
if(chats.length===1){alert("Can't delete last chat!");return;}
if(!confirm('Delete this chat?'))return;
await supabase.from('chats').delete().eq('id',chatId);
const newChats=chats.filter(c=>c.id!==chatId);
setChats(newChats);
if(currentChatId===chatId)setCurrentChatId(newChats[0]?.id);
};

const renameChat=async(chatId,newName)=>{
await supabase.from('chats').update({name:newName}).eq('id',chatId);
setChats(chats.map(c=>c.id===chatId?{...c,name:newName}:c));
setEditingChatId(null);
};

const updateChatModel=async(model)=>{
await supabase.from('chats').update({model}).eq('id',currentChatId);
setChats(chats.map(c=>c.id===currentChatId?{...c,model}:c));
};

const handleAuth=async()=>{
try{
if(isSignup){
if(inviteCode!==INVITE_CODE){
alert('Invalid invite code!');
return;
}
const {error}=await supabase.auth.signUp({email,password});
if(error)throw error;
alert('Account created! Please log in.');
setIsSignup(false);
}else{
const {error}=await supabase.auth.signInWithPassword({email,password});
if(error)throw error;
}
}catch(error){
alert(error.message);
}
};

const handleFileSelect=async(e)=>{
const file=e.target.files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=async(event)=>{
setAttachedFile({
name:file.name,
type:file.type,
data:event.target.result.split(',')[1]
});
};
reader.readAsDataURL(file);
};

const enhancePrompt=async()=>{
if(!input.trim())return;
const enhancerKey=apiKeys.cerebras||apiKeys.groq;
if(!enhancerKey){
alert('Need an API key to enhance prompts');
return;
}
setLoading(true);
try{
const res=await fetch('https://api.cerebras.ai/v1/chat/completions',{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${enhancerKey}`},
body:JSON.stringify({
model:'llama3.3-70b',
messages:[{role:'user',content:`Improve this prompt to be more detailed and effective: "${input}"`}],
max_tokens:500
})
});
const data=await res.json();
setInput(data.choices[0].message.content);
}catch(error){
alert('Error enhancing prompt');
}finally{
setLoading(false);
}
};
const sendMessage=async()=>{
if(!input.trim()||!currentChat)return;
const model=models.find(m=>m.id===currentChat.model);
const apiKey=apiKeys[model.provider];
if(!apiKey){
alert(`Please add ${model.provider} API key in settings`);
setShowSettings(true);
return;
}
const userMsg={role:'user',content:input,file:attachedFile,timestamp:new Date().toISOString()};
const newMsgs=[...(currentChat.messages||[]),userMsg];
setChats(chats.map(c=>c.id===currentChatId?{...c,messages:newMsgs}:c));
if((!currentChat.messages||currentChat.messages.length===0)&&currentChat.name==='New Chat'){
const chatName=input.slice(0,30)+(input.length>30?'...':'');
await supabase.from('chats').update({name:chatName}).eq('id',currentChatId);
setChats(chats.map(c=>c.id===currentChatId?{...c,name:chatName}:c));
}
setInput('');
setAttachedFile(null);
setLoading(true);
try{
const history=newMsgs.map(m=>({role:m.role==='assistant'?'assistant':'user',content:m.content}));
let response;
if(model.provider==='google'){
const contents=history.map((msg,idx)=>{
const parts=[{text:msg.content}];
if(idx===history.length-1&&attachedFile){
parts.push({inline_data:{mime_type:attachedFile.type,data:attachedFile.data}});
}
return {role:msg.role==='user'?'user':'model',parts};
});
const res=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model.endpoint}:generateContent?key=${apiKey}`,{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({contents})
});
const data=await res.json();
response=data.candidates[0].content.parts[0].text;
}else if(model.provider==='cerebras'){
const res=await fetch('https://api.cerebras.ai/v1/chat/completions',{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${apiKey}`},
body:JSON.stringify({model:model.endpoint,messages:history,max_tokens:4096})
});
const data=await res.json();
response=data.choices[0].message.content;
}else if(model.provider==='groq'){
const res=await fetch('https://api.groq.com/openai/v1/chat/completions',{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${apiKey}`},
body:JSON.stringify({model:model.endpoint,messages:history,max_tokens:4096})
});
const data=await res.json();
response=data.choices[0].message.content;
}else if(model.provider==='deepseek'){
const res=await fetch('https://api.deepseek.com/chat/completions',{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${apiKey}`},
body:JSON.stringify({model:model.endpoint,messages:history,max_tokens:4096})
});
const data=await res.json();
response=data.choices[0].message.content;
}
const assistantMsg={role:'assistant',content:response,timestamp:new Date().toISOString()};
const updatedMsgs=[...newMsgs,assistantMsg];
await supabase.from('chats').update({messages:updatedMsgs}).eq('id',currentChatId);
setChats(chats.map(c=>c.id===currentChatId?{...c,messages:updatedMsgs}:c));
}catch(error){
alert('Error: '+error.message);
}finally{
setLoading(false);
}
};
const sendCompareMessage=async()=>{
if(!input.trim())return;
setLoading(true);
const responses=[];
for(const modelId of selectedModels){
const model=models.find(m=>m.id===modelId);
const apiKey=apiKeys[model.provider];
if(!apiKey)continue;
try{
let response;
if(model.provider==='google'){
const res=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model.endpoint}:generateContent?key=${apiKey}`,{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({contents:[{role:'user',parts:[{text:input}]}]})
});
const data=await res.json();
response=data.candidates[0].content.parts[0].text;
}else{
const endpoint=model.provider==='cerebras'?'https://api.cerebras.ai/v1/chat/completions':
model.provider==='groq'?'https://api.groq.com/openai/v1/chat/completions':
'https://api.deepseek.com/chat/completions';
const res=await fetch(endpoint,{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${apiKey}`},
body:JSON.stringify({model:model.endpoint,messages:[{role:'user',content:input}],max_tokens:4096})
});
const data=await res.json();
response=data.choices[0].message.content;
}
responses.push({model:model.name,response});
}catch(error){
responses.push({model:model.name,response:'Error: '+error.message});
}
}
setLoading(false);
return responses;
};

const generateImage=async()=>{
if(!imagePrompt.trim())return;
setLoading(true);
try{
const url=`https://image.pollinations.ai/prompt/${encodeURIComponent(imagePrompt)}?width=1024&height=1024&nologo=true`;
setGeneratedImage(url);
}catch(error){
alert('Error generating image');
}finally{
setLoading(false);
}
};
if(!session){
return(
<div className="flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900">
<div className="bg-gray-800 p-8 rounded-2xl w-96 border border-gray-700">
<div className="text-center mb-8">
<div className="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full mx-auto mb-4 flex items-center justify-center">
<UserIcon/>
</div>
<h1 className="text-3xl font-bold text-white mb-2">Multi-AI Platform</h1>
<p className="text-gray-400">Your personal AI suite</p>
</div>
<div className="space-y-4">
<input type="email" value={email} onChange={(e)=>setEmail(e.target.value)} placeholder="Email"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<input type="password" value={password} onChange={(e)=>setPassword(e.target.value)} placeholder="Password"
onKeyPress={(e)=>e.key==='Enter'&&handleAuth()}
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
{isSignup&&(
<input type="text" value={inviteCode} onChange={(e)=>setInviteCode(e.target.value)} placeholder="Invite Code"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
)}
<button onClick={handleAuth} className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold">
{isSignup?'Sign Up':'Login'}
</button>
<button onClick={()=>setIsSignup(!isSignup)} className="w-full text-blue-400 hover:text-blue-300 text-sm">
{isSignup?'Have an account? Login':'Need an account? Sign up'}
</button>
</div>
</div>
</div>
);
}

if(showSettings){
return <SettingsScreen apiKeys={apiKeys} setApiKeys={setApiKeys} setShowSettings={setShowSettings} session={session}/>;
}

if(view==='compare'){
return <CompareView input={input} setInput={setInput} loading={loading} sendCompareMessage={sendCompareMessage}
selectedModels={selectedModels} setSelectedModels={setSelectedModels} setView={setView}/>;
}

if(view==='image'){
return <ImageGenView imagePrompt={imagePrompt} setImagePrompt={setImagePrompt} generateImage={generateImage}
generatedImage={generatedImage} loading={loading} setView={setView}/>;
}
return(
<div className="flex h-screen bg-gray-900 text-white">
{/* Sidebar */}
<div className={`${showSidebar?'w-64':'w-0'} bg-gray-800 border-r border-gray-700 flex flex-col transition-all overflow-hidden`}>
<div className="p-4 border-b border-gray-700 space-y-2">
<button onClick={()=>createNewChat()} className="w-full bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg flex items-center justify-center gap-2">
<PlusIcon/>New Chat
</button>
<button onClick={()=>setView('compare')} className="w-full bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg flex items-center justify-center gap-2 text-sm">
<ColumnsIcon/>Compare AIs
</button>
<button onClick={()=>setView('image')} className="w-full bg-pink-600 hover:bg-pink-700 px-4 py-2 rounded-lg flex items-center justify-center gap-2 text-sm">
<ImageIcon/>Generate Image
</button>
</div>
<div className="flex-1 overflow-y-auto custom-scrollbar p-2">
{chats.map(chat=>(
<div key={chat.id} className={`p-3 mb-2 rounded-lg cursor-pointer group ${currentChatId===chat.id?'bg-gray-700':'hover:bg-gray-750'}`}
onClick={()=>setCurrentChatId(chat.id)}>
<div className="flex items-center justify-between">
{editingChatId===chat.id?(
<input type="text" value={editingName} onChange={(e)=>setEditingName(e.target.value)}
onBlur={()=>renameChat(chat.id,editingName)}
onKeyPress={(e)=>e.key==='Enter'&&renameChat(chat.id,editingName)}
className="bg-gray-600 px-2 py-1 rounded text-sm flex-1 text-white" autoFocus
onClick={(e)=>e.stopPropagation()}/>
):(
<>
<div className="flex items-center gap-2 flex-1 min-w-0">
<MessageIcon/><span className="text-sm truncate">{chat.name}</span>
</div>
<div className="flex gap-1 opacity-0 group-hover:opacity-100">
<button onClick={(e)=>{e.stopPropagation();setEditingChatId(chat.id);setEditingName(chat.name);}}
className="p-1 hover:bg-gray-600 rounded"><EditIcon/></button>
<button onClick={(e)=>{e.stopPropagation();deleteChat(chat.id);}}
className="p-1 hover:bg-gray-600 rounded"><TrashIcon/></button>
</div>
</>
)}
</div>
<div className="text-xs text-gray-400 mt-1">{models.find(m=>m.id===chat.model)?.name}</div>
</div>
))}
</div>
<div className="p-4 border-t border-gray-700">
<div className="flex items-center gap-3 mb-3">
<div className="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
{isAdmin?<ShieldIcon/>:<UserIcon/>}
</div>
<div className="flex-1 min-w-0">
<span className="text-sm font-semibold block truncate">{session.user.email}</span>
{isAdmin&&<span className="text-xs text-yellow-400">Admin</span>}
</div>
</div>
<div className="flex gap-2">
<button onClick={()=>setShowSettings(true)} className="flex-1 p-2 bg-gray-700 hover:bg-gray-600 rounded-lg">
<SettingsIcon/>
</button>
<button onClick={()=>supabase.auth.signOut()} className="p-2 bg-gray-700 hover:bg-gray-600 rounded-lg">
<LogOutIcon/>
</button>
</div>
</div>
</div>

{/* Main Chat Area */}
<div className="flex-1 flex flex-col">
<div className="bg-gray-800 border-b border-gray-700 p-4 flex items-center justify-between">
<button onClick={()=>setShowSidebar(!showSidebar)} className="p-2 hover:bg-gray-700 rounded-lg mr-3">‚ò∞</button>
<div className="flex-1"><div className="font-semibold">{currentChat?.name||'Chat'}</div></div>
{currentChat&&(
<select value={currentChat.model} onChange={(e)=>updateChatModel(e.target.value)}
className="bg-gray-700 text-white px-3 py-2 rounded-lg text-sm border border-gray-600">
{models.map(m=><option key={m.id} value={m.id}>{m.name}</option>)}
</select>
)}
</div>

<div className="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">
{currentChat&&(!currentChat.messages||currentChat.messages.length===0)&&(
<div className="text-center text-gray-500 mt-20">
<div className="text-6xl mb-4">üëã</div>
<div className="text-xl">Start a conversation</div>
<div className="text-sm mt-2">Using {models.find(m=>m.id===currentChat.model)?.name}</div>
</div>
)}
{currentChat?.messages?.map((msg,idx)=>(
<div key={idx} className={`flex ${msg.role==='user'?'justify-end':'justify-start'}`}>
<div className={`max-w-[80%] rounded-2xl p-4 ${msg.role==='user'?'bg-blue-600':'bg-gray-800'}`}>
{msg.file&&<div className="text-xs mb-2 opacity-75">üìé {msg.file.name}</div>}
{msg.role==='user'?(
<div className="whitespace-pre-wrap">{msg.content}</div>
):(
<div className="markdown-content" dangerouslySetInnerHTML={{__html:marked.parse(msg.content)}}/>
)}
</div>
</div>
))}
{loading&&(
<div className="flex justify-start">
<div className="bg-gray-800 rounded-2xl p-4">
<div className="flex gap-2">
<div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce-1"/>
<div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce-2"/>
<div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce-3"/>
</div>
</div>
</div>
)}
<div ref={messagesEndRef}/>
</div>

<div className="bg-gray-800 border-t border-gray-700 p-4">
{attachedFile&&(
<div className="mb-2 flex items-center gap-2 bg-gray-700 p-2 rounded">
<span className="text-sm">üìé {attachedFile.name}</span>
<button onClick={()=>setAttachedFile(null)} className="text-red-400 hover:text-red-300">√ó</button>
</div>
)}
<div className="flex gap-2">
<input type="file" ref={fileInputRef} onChange={handleFileSelect} accept="image/*,application/pdf,.txt" className="hidden"/>
<button onClick={()=>fileInputRef.current?.click()} disabled={loading}
className="p-3 bg-gray-700 hover:bg-gray-600 rounded-lg disabled:opacity-50" title="Attach file">
<PaperclipIcon/>
</button>
<button onClick={enhancePrompt} disabled={loading||!input.trim()}
className="p-3 bg-purple-600 hover:bg-purple-700 rounded-lg disabled:opacity-50" title="Enhance prompt">
<SparklesIcon/>
</button>
<input type="text" value={input} onChange={(e)=>setInput(e.target.value)}
onKeyPress={(e)=>e.key==='Enter'&&!e.shiftKey&&sendMessage()}
placeholder="Type a message..." disabled={loading}
className="flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<button onClick={sendMessage} disabled={loading||!input.trim()}
className="px-6 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50">
<SendIcon/>
</button>
</div>
</div>
</div>
</div>
);
}
function CompareView({input,setInput,loading,sendCompareMessage,selectedModels,setSelectedModels,setView}){
const [responses,setResponses]=useState([]);

const handleSend=async()=>{
const results=await sendCompareMessage();
setResponses(results);
};

return(
<div className="min-h-screen bg-gray-900 text-white p-8">
<div className="max-w-7xl mx-auto">
<button onClick={()=>setView('chat')} className="text-blue-400 hover:text-blue-300 mb-4">‚Üê Back to Chat</button>
<h1 className="text-3xl font-bold mb-6">Compare AI Models</h1>
<div className="mb-6">
<div className="flex flex-wrap gap-4 mb-4">
{models.map(m=>(
<label key={m.id} className="flex items-center gap-2 cursor-pointer bg-gray-800 px-4 py-2 rounded-lg hover:bg-gray-700">
<input type="checkbox" checked={selectedModels.includes(m.id)}
onChange={(e)=>e.target.checked?setSelectedModels([...selectedModels,m.id]):setSelectedModels(selectedModels.filter(id=>id!==m.id))}
className="w-4 h-4"/>
<span>{m.name}</span>
</label>
))}
</div>
<div className="flex gap-2">
<input type="text" value={input} onChange={(e)=>setInput(e.target.value)}
onKeyPress={(e)=>e.key==='Enter'&&handleSend()}
placeholder="Enter prompt to compare across models..."
className="flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<button onClick={handleSend} disabled={loading||!input.trim()||selectedModels.length===0}
className="px-6 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 font-semibold">
Compare
</button>
</div>
</div>
{responses.length>0&&(
<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
{responses.map((r,idx)=>(
<div key={idx} className="bg-gray-800 p-6 rounded-2xl border border-gray-700">
<h3 className="font-bold mb-4 text-blue-400 text-lg">{r.model}</h3>
<div className="markdown-content" dangerouslySetInnerHTML={{__html:marked.parse(r.response)}}/>
</div>
))}
</div>
)}
{responses.length===0&&!loading&&(
<div className="text-center text-gray-500 mt-20">
<div className="text-6xl mb-4">üîÑ</div>
<div className="text-xl">Select models and enter a prompt</div>
<div className="text-sm mt-2">Compare responses side-by-side</div>
</div>
)}
</div>
</div>
);
}
function ImageGenView({imagePrompt,setImagePrompt,generateImage,generatedImage,loading,setView}){
return(
<div className="min-h-screen bg-gray-900 text-white p-8">
<div className="max-w-4xl mx-auto">
<button onClick={()=>setView('chat')} className="text-blue-400 hover:text-blue-300 mb-4">‚Üê Back to Chat</button>
<h1 className="text-3xl font-bold mb-6">Generate Images</h1>
<p className="text-gray-400 mb-6">Powered by Pollinations.ai - 100% free, no API key needed!</p>
<div className="mb-6 flex gap-2">
<input type="text" value={imagePrompt} onChange={(e)=>setImagePrompt(e.target.value)}
onKeyPress={(e)=>e.key==='Enter'&&generateImage()}
placeholder="Describe the image you want to create..."
className="flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<button onClick={generateImage} disabled={loading||!imagePrompt.trim()}
className="px-6 bg-pink-600 hover:bg-pink-700 rounded-lg disabled:opacity-50 font-semibold">
Generate
</button>
</div>
{loading&&(
<div className="text-center py-20">
<div className="text-6xl mb-4">üé®</div>
<div className="text-xl">Generating your image...</div>
</div>
)}
{generatedImage&&!loading&&(
<div className="bg-gray-800 p-4 rounded-2xl border border-gray-700">
<img src={generatedImage} alt="Generated" className="w-full rounded-lg mb-4"/>
<div className="flex gap-2">
<a href={generatedImage} download="generated-image.png" 
className="flex-1 text-center bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-semibold">
Download Image
</a>
<button onClick={()=>setGeneratedImage(null)} 
className="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg">
Clear
</button>
</div>
</div>
)}
{!generatedImage&&!loading&&(
<div className="text-center text-gray-500 mt-20">
<div className="text-6xl mb-4">üñºÔ∏è</div>
<div className="text-xl">Ready to create</div>
<div className="text-sm mt-2">Describe any image and watch it come to life</div>
</div>
)}
</div>
</div>
);
}
function SettingsScreen({apiKeys,setApiKeys,setShowSettings,session}){
const [google,setGoogle]=useState(apiKeys.google||'');
const [cerebras,setCerebras]=useState(apiKeys.cerebras||'');
const [groq,setGroq]=useState(apiKeys.groq||'');
const [deepseek,setDeepseek]=useState(apiKeys.deepseek||'');

const saveKeys=async()=>{
const keys={google,cerebras,groq,deepseek};
for(const [provider,keyValue] of Object.entries(keys)){
if(!keyValue)continue;
await supabase.from('api_keys').upsert({
user_id:session.user.id,
provider,
key_value:keyValue
},{onConflict:'user_id,provider'});
}
setApiKeys(keys);
alert('API Keys saved successfully!');
setShowSettings(false);
};

return(
<div className="min-h-screen bg-gray-900 text-white p-8">
<div className="max-w-2xl mx-auto">
<button onClick={()=>setShowSettings(false)} className="text-blue-400 hover:text-blue-300 mb-4">
‚Üê Back to Chat
</button>
<h1 className="text-3xl font-bold mb-2">Settings</h1>
<p className="text-gray-400 mb-6">Configure your API keys</p>

<div className="space-y-6 bg-gray-800 p-6 rounded-2xl border border-gray-700">
<div>
<label className="block text-sm font-semibold mb-2">Google AI Studio API Key</label>
<input type="password" value={google} onChange={(e)=>setGoogle(e.target.value)} 
placeholder="Your Gemini API key"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer" 
className="text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block">
Get your key here ‚Üí
</a>
</div>

<div>
<label className="block text-sm font-semibold mb-2">Cerebras API Key</label>
<input type="password" value={cerebras} onChange={(e)=>setCerebras(e.target.value)} 
placeholder="Your Cerebras API key"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<a href="https://cloud.cerebras.ai/" target="_blank" rel="noopener noreferrer" 
className="text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block">
Get your key here ‚Üí
</a>
</div>

<div>
<label className="block text-sm font-semibold mb-2">Groq API Key</label>
<input type="password" value={groq} onChange={(e)=>setGroq(e.target.value)} 
placeholder="Your Groq API key"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<a href="https://console.groq.com/keys" target="_blank" rel="noopener noreferrer" 
className="text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block">
Get your key here ‚Üí
</a>
</div>

<div>
<label className="block text-sm font-semibold mb-2">DeepSeek API Key</label>
<input type="password" value={deepseek} onChange={(e)=>setDeepseek(e.target.value)} 
placeholder="Your DeepSeek API key"
className="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/>
<a href="https://platform.deepseek.com/api_keys" target="_blank" rel="noopener noreferrer" 
className="text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block">
Get your key here ‚Üí
</a>
</div>

<button onClick={saveKeys} 
className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition">
Save API Keys
</button>
</div>

<div className="mt-6 bg-gray-800 p-6 rounded-2xl border border-gray-700">
<h2 className="text-xl font-bold mb-4">How to Use</h2>
<ol className="space-y-2 text-sm text-gray-300 list-decimal list-inside">
<li>Get free API keys from the links above</li>
<li>Paste them into the fields and save</li>
<li>Select a model in chat and start chatting</li>
<li>Use Compare mode to test multiple models at once</li>
<li>Generate images without any API key!</li>
</ol>
</div>
</div>
</div>
);
}
ReactDOM.createRoot(document.getElementById('app')).render(<App/>);
</script>
</body>
</html>
